<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Place</title>
</head>
<body onload="fetchEventList()">
    <h2> Welcome to Event Page</h2>
    <p id="response"> response</p>
    <table id="employees"></table>
    <!--<div onload="fetchEventList()">Trending Events</div> -->
    <script >
        const url="http://localhost:3000/event"
async function fetchEventList(){
    let iat = Math.floor(Date.now() / 1000);
    const exp= Math.floor((Date.now()+(3600*24*1000))/1000);
    const metaData={
        limit:10,
        page:1
    };
    const body={
        data:{
            iat,
            exp,
            metaData
        }
    }
    const eventList= await fetch(url,{
        headers:{
            "Content-Type": 'application/json'
        },
        method:"POST",
        body:JSON.stringify(body)

        }).then(async response=>{
            const resp= await response.json()
            console.log(resp)
            if(resp){
                $("#response").html(resp)
              console.log(resp)
              show(resp)
            }
        })
    }

async function show(response){
    let tab = 
        `<tr>
          <th>Event Id</th>
          <th>Event Name</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th> ProjectStatus</th>
         
         </tr>`;
    
    // Loop to access all rows 
    for (let r of data.list) {
        tab += `<tr> 
    <td>${r._id} </td>
    <td>${r.projectName}</td>
    <td>${r.fromDate}</td> 
    <td>${r.toDate}</td>   
    <td>${r.projectStatus}</td>          

</tr>`;
    }
    // Setting innerHTML as tab variable
    document.getElementById("employees").innerHTML = tab;
} 

    </script>
</body>
</html>